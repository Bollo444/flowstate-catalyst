(()=>{var e={};e.id=268,e.ids=[268],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},56131:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>i}),r(82424),r(94347),r(52593);var a=r(93826),s=r(49930),o=r(42049),n=r.n(o),l=r(88405),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let i=["",{children:["inventory",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,82424)),"C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\inventory\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,94347)),"C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52593,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\inventory\\page.tsx"],u="/inventory/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/inventory/page",pathname:"/inventory",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},77385:(e,t,r)=>{Promise.resolve().then(r.bind(r,55454))},44558:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(76824).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},58339:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(76824).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},93006:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(76824).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},55454:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(31694),s=r(51010);class o{constructor(e){(function(e,t,r){var a;(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(this,"userId",void 0),this.userId=e}async getProducts(){let{data:e,error:t}=await s.OQ.from("products").select("*").order("name");return t?(console.error("Error fetching products:",t),[]):e}async getProductById(e){let{data:t,error:r}=await s.OQ.from("products").select("*").eq("id",e).single();return r?(console.error("Error fetching product:",r),null):t}async createProduct(e){let{data:t,error:r}=await s.OQ.from("products").insert([e]).select().single();return r?(console.error("Error creating product:",r),null):t}async updateProduct(e,t){let{data:r,error:a}=await s.OQ.from("products").update(t).eq("id",e).select().single();return a?(console.error("Error updating product:",a),null):r}async deleteProduct(e){let{error:t}=await s.OQ.from("products").delete().eq("id",e);return!t||(console.error("Error deleting product:",t),!1)}async getStockLocations(){let{data:e,error:t}=await s.OQ.from("stock_locations").select("*").order("name");return t?(console.error("Error fetching stock locations:",t),[]):e}async getStockLocationById(e){let{data:t,error:r}=await s.OQ.from("stock_locations").select("*").eq("id",e).single();return r?(console.error("Error fetching stock location:",r),null):t}async createStockLocation(e){let{data:t,error:r}=await s.OQ.from("stock_locations").insert([e]).select().single();return r?(console.error("Error creating stock location:",r),null):t}async updateStockLocation(e,t){let{data:r,error:a}=await s.OQ.from("stock_locations").update(t).eq("id",e).select().single();return a?(console.error("Error updating stock location:",a),null):r}async getInventoryItems(e,t){let r=s.OQ.from("inventory_items").select("*");e&&(r=r.eq("product_id",e)),t&&(r=r.eq("location_id",t));let{data:a,error:o}=await r;return o?(console.error("Error fetching inventory items:",o),[]):a}async getInventoryItemById(e){let{data:t,error:r}=await s.OQ.from("inventory_items").select("*").eq("id",e).single();return r?(console.error("Error fetching inventory item:",r),null):t}async createInventoryItem(e){let{data:t,error:r}=await s.OQ.from("inventory_items").insert([e]).select().single();return r?(console.error("Error creating inventory item:",r),null):t}async updateInventoryItem(e,t){let{data:r,error:a}=await s.OQ.from("inventory_items").update(t).eq("id",e).select().single();return a?(console.error("Error updating inventory item:",a),null):r}async getStockMovements(e,t){let r=s.OQ.from("stock_movements").select("*").order("created_at",{ascending:!1});e&&(r=r.eq("product_id",e)),t&&(r=r.eq("movement_type",t));let{data:a,error:o}=await r;return o?(console.error("Error fetching stock movements:",o),[]):a}async createStockMovement(e){let{data:t,error:r}=await s.OQ.rpc("create_stock_movement",{p_product_id:e.product_id,p_source_location_id:e.source_location_id,p_destination_location_id:e.destination_location_id,p_quantity:e.quantity,p_movement_type:e.movement_type,p_reference_number:e.reference_number,p_notes:e.notes,p_performed_by:this.userId});return r?(console.error("Error creating stock movement:",r),null):t}async getLowStockAlerts(e=!1){let{data:t,error:r}=await s.OQ.from("low_stock_alerts").select("*").eq("is_resolved",e).order("created_at",{ascending:!1});return r?(console.error("Error fetching low stock alerts:",r),[]):t}async resolveLowStockAlert(e){let t={is_resolved:e.is_resolved,resolved_at:e.is_resolved?new Date().toISOString():null},{data:r,error:a}=await s.OQ.from("low_stock_alerts").update(t).eq("id",e.id).select().single();return a?(console.error("Error resolving low stock alert:",a),null):r}async checkAndGenerateLowStockAlerts(){let{data:e,error:t}=await s.OQ.rpc("generate_low_stock_alerts");return t?(console.error("Error generating low stock alerts:",t),0):e}}var n=r(76824);let l=(0,n.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),d=(0,n.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var i=r(44558),c=r(93006),u=r(58339),x=r(52166);let m=()=>{let{session:e}=(0,s.$4)(),t=e?.user,{0:r,1:n}=(0,a.useState)([]),{0:m,1:g}=(0,a.useState)([]),{0:p,1:h}=(0,a.useState)([]),{0:y,1:b}=(0,a.useState)([]),{0:f,1:v}=(0,a.useState)([]),{0:k,1:w}=(0,a.useState)(!0),{0:j,1:N}=(0,a.useState)(null),{0:_,1:S}=(0,a.useState)("overview");(0,a.useEffect)(()=>{t?.id&&q()},[t]);let q=async()=>{if(!t?.id)return;w(!0);let e=new o(t.id);try{let[t,r,a]=await Promise.all([e.getProducts(),e.getStockLocations(),e.getLowStockAlerts(!1)]);n(t),g(r),b(a);let s=await e.getInventoryItems();h(s);let o=P(t,r,s,a);v(o)}catch(e){console.error("Error loading inventory data:",e),N("Failed to load inventory data. Please try again.")}finally{w(!1)}},P=(e,t,r,a)=>{let s=[],o=new Map;return a.forEach(e=>{o.set(e.product_id,!0)}),e.forEach(e=>{let a=r.filter(t=>t.product_id===e.id),n=a.reduce((e,t)=>e+t.quantity,0),l=a.map(e=>{let r=t.find(t=>t.id===e.location_id);return{location_id:e.location_id,location_name:r?.name||"Unknown Location",quantity:e.quantity}});s.push({product_id:e.id,product_name:e.name,sku:e.sku,category:e.category,total_quantity:n,locations:l,low_stock:o.has(e.id)||n<=e.low_stock_threshold})}),s},C=()=>x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:x.jsx("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,x.jsxs)("tr",{children:[x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"SKU"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Category"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Quantity"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:f.map(e=>(0,x.jsxs)("tr",{children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.product_name}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.sku}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize",children:e.category}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.total_quantity}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.low_stock?x.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Low Stock"}):x.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"In Stock"})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:x.jsx("button",{className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:"View Details"})})]},e.product_id))})]})})});return(0,x.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,x.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[x.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Inventory Management"}),(0,x.jsxs)("div",{className:"flex space-x-2",children:[(0,x.jsxs)("button",{onClick:()=>{q()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[x.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,x.jsxs)("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[x.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Add Product"]})]})]}),k?x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):j?(0,x.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:j}),(0,x.jsxs)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>N(null),children:[x.jsx("span",{className:"sr-only",children:"Dismiss"}),(0,x.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[x.jsx("title",{children:"Close"}),x.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})]})]}):(0,x.jsxs)(x.Fragment,{children:[x.jsx("div",{className:"mb-6",children:x.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,x.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[x.jsx("button",{onClick:()=>S("overview"),className:`${"overview"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Overview"}),x.jsx("button",{onClick:()=>S("products"),className:`${"products"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Products"}),x.jsx("button",{onClick:()=>S("locations"),className:`${"locations"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:"Locations"}),(0,x.jsxs)("button",{onClick:()=>S("alerts"),className:`${"alerts"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:["Low Stock Alerts",y.length>0&&x.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full dark:bg-red-900 dark:text-red-200",children:y.length})]})]})})}),(0,x.jsxs)("div",{children:["overview"===_&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[(0,x.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,x.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[x.jsx(l,{className:"mr-2 h-5 w-5 text-blue-500"}),"Products"]}),x.jsx("p",{className:"text-3xl font-bold",children:r.length}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Total products in inventory"})]}),(0,x.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,x.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[x.jsx(d,{className:"mr-2 h-5 w-5 text-green-500"}),"Locations"]}),x.jsx("p",{className:"text-3xl font-bold",children:m.length}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Active storage locations"})]}),(0,x.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,x.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[x.jsx(i.Z,{className:"mr-2 h-5 w-5 text-red-500"}),"Low Stock Alerts"]}),x.jsx("p",{className:"text-3xl font-bold",children:y.length}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Items requiring attention"})]})]}),C()]}),"products"===_&&C(),"locations"===_&&x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(e=>(0,x.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[x.jsx("h3",{className:"text-lg font-medium mb-2",children:e.name}),x.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:e.description||"No description"}),(0,x.jsxs)("p",{className:"text-sm",children:[x.jsx("span",{className:"font-medium",children:"Code:"})," ",e.location_code]}),(0,x.jsxs)("p",{className:"text-sm",children:[x.jsx("span",{className:"font-medium",children:"Status:"})," ",e.is_active?"Active":"Inactive"]}),x.jsx("div",{className:"mt-4 flex justify-end",children:x.jsx("button",{className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"View Inventory"})})]},e.id))}),"alerts"===_&&(0===y.length?x.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow text-center",children:x.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No low stock alerts at this time."})}):x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:x.jsx("div",{className:"overflow-x-auto",children:(0,x.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,x.jsxs)("tr",{children:[x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Location"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Current Quantity"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Threshold"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Created"}),x.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:y.map(e=>{let a=r.find(t=>t.id===e.product_id),s=m.find(t=>t.id===e.location_id);return(0,x.jsxs)("tr",{children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a?.name||"Unknown Product"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:s?.name||"Unknown Location"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.current_quantity}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.threshold}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.created_at).toLocaleDateString()}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:x.jsx("button",{onClick:async()=>{if(!t?.id)return;let r=new o(t.id);try{await r.resolveLowStockAlert({id:e.id,is_resolved:!0}),q()}catch(e){console.error("Error resolving alert:",e),N("Failed to resolve alert. Please try again.")}},className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:"Resolve"})})]},e.id)})})]})})}))]})]})]})},g=(0,n.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),p=({onComplete:e,onCancel:t,productId:r,locationId:n})=>{let{session:l}=(0,s.$4)(),d=l?.user,{0:i,1:c}=(0,a.useState)([]),{0:m,1:p}=(0,a.useState)([]),{0:h,1:y}=(0,a.useState)(!0),{0:b,1:f}=(0,a.useState)(!1),{0:v,1:k}=(0,a.useState)(null),{0:w,1:j}=(0,a.useState)(!1),{0:N,1:_}=(0,a.useState)(r||""),{0:S,1:q}=(0,a.useState)("purchase"),{0:P,1:C}=(0,a.useState)(n||""),{0:E,1:L}=(0,a.useState)(n||""),{0:I,1:M}=(0,a.useState)(1),{0:A,1:O}=(0,a.useState)(""),{0:Q,1:Z}=(0,a.useState)("");(0,a.useEffect)(()=>{d?.id&&B()},[d]);let B=async()=>{if(!d?.id)return;y(!0);let e=new o(d.id);try{let[t,a]=await Promise.all([e.getProducts(),e.getStockLocations()]);c(t),p(a),r?_(r):t.length>0&&_(t[0].id),n?(C(n),L(n)):a.length>0&&(C(a[0].id),L(a[0].id))}catch(e){console.error("Error loading data:",e),k("Failed to load products and locations. Please try again.")}finally{y(!1)}},G=async t=>{if(t.preventDefault(),d?.id&&N){k(null),f(!0);try{let t=new o(d.id),r={product_id:N,quantity:I,movement_type:S,reference_number:A||null,notes:Q||null,source_location_id:["sale","transfer"].includes(S)?P:null,destination_location_id:["purchase","transfer","count"].includes(S)?E:null};if("purchase"===S&&!E){k("Destination location is required for purchases"),f(!1);return}if("sale"===S&&!P){k("Source location is required for sales"),f(!1);return}if("transfer"===S&&(!P||!E)){k("Both source and destination locations are required for transfers"),f(!1);return}if("count"===S&&!E){k("Location is required for inventory counts"),f(!1);return}await t.createStockMovement(r)?(j(!0),setTimeout(()=>{e?e():(j(!1),R())},1500)):k("Failed to record stock movement. Please try again.")}catch(e){console.error("Error creating stock movement:",e),k(e.message||"An unexpected error occurred")}finally{f(!1)}}},R=()=>{_(i.length>0?i[0].id:""),q("purchase"),C(m.length>0?m[0].id:""),L(m.length>0?m[0].id:""),M(1),O(""),Z("")};return h?x.jsx("div",{className:"p-4 flex justify-center items-center",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,x.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,x.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Record Stock Movement"}),t&&x.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:x.jsx(g,{className:"h-5 w-5"})})]}),v&&x.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 rounded-md",children:v}),w&&x.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-md",children:"Stock movement recorded successfully!"}),(0,x.jsxs)("form",{onSubmit:G,children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,x.jsxs)("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product"}),(0,x.jsxs)("select",{value:N,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[x.jsx("option",{value:"",children:"Select a product"}),i.map(e=>(0,x.jsxs)("option",{value:e.id,children:[e.name," (",e.sku,")"]},e.id))]})]}),(0,x.jsxs)("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Movement Type"}),(0,x.jsxs)("select",{value:S,onChange:e=>q(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[x.jsx("option",{value:"purchase",children:"Purchase (Add Stock)"}),x.jsx("option",{value:"sale",children:"Sale (Remove Stock)"}),x.jsx("option",{value:"transfer",children:"Transfer Between Locations"}),x.jsx("option",{value:"adjustment",children:"Inventory Adjustment"}),x.jsx("option",{value:"count",children:"Inventory Count"})]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[["sale","transfer","adjustment"].includes(S)&&(0,x.jsxs)("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"transfer"===S?"Source Location":"Location"}),(0,x.jsxs)("select",{value:P,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[x.jsx("option",{value:"",children:"Select a location"}),m.map(e=>(0,x.jsxs)("option",{value:e.id,children:[e.name," (",e.location_code,")"]},e.id))]})]}),["purchase","transfer","count","adjustment"].includes(S)&&(0,x.jsxs)("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"transfer"===S?"Destination Location":"Location"}),(0,x.jsxs)("select",{value:E,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[x.jsx("option",{value:"",children:"Select a location"}),m.map(e=>(0,x.jsxs)("option",{value:e.id,children:[e.name," (",e.location_code,")"]},e.id))]})]}),(0,x.jsxs)("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quantity"}),x.jsx("input",{type:"number",min:"1",value:I,onChange:e=>M(parseInt(e.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reference Number (Optional)"}),x.jsx("input",{type:"text",value:A,onChange:e=>O(e.target.value),placeholder:"Invoice #, PO #, etc.",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,x.jsxs)("div",{className:"mb-6",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes (Optional)"}),x.jsx("textarea",{value:Q,onChange:e=>Z(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Additional details about this stock movement"})]}),(0,x.jsxs)("div",{className:"flex justify-end space-x-3",children:[t&&x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:b,children:"Cancel"}),x.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",disabled:b,children:b?(0,x.jsxs)(x.Fragment,{children:[x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Processing..."]}):(0,x.jsxs)(x.Fragment,{children:[x.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Record Movement"]})})]})]})]})},h=()=>{let{0:e,1:t}=(0,a.useState)(!1);return(0,x.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[!e&&x.jsx("div",{className:"flex justify-end mb-6",children:(0,x.jsxs)("button",{onClick:()=>t(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[x.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Record Stock Movement"]})}),e?x.jsx("div",{className:"mb-8",children:x.jsx(p,{onComplete:()=>t(!1),onCancel:()=>t(!1)})}):x.jsx(m,{})]})}},82424:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(87866).createProxy)(String.raw`C:\Bollo\Github\flowstate-catalyst\src\app\inventory\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[237,479,494,679,965],()=>r(56131));module.exports=a})();