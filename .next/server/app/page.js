(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},58011:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>l}),r(12283),r(94347),r(52593);var s=r(93826),i=r(49930),a=r(42049),o=r.n(a),n=r(88405),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);r.d(t,c);let l=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,12283)),"C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,94347)),"C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52593,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Bollo\\Github\\flowstate-catalyst\\src\\app\\page.tsx"],d="/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},90580:(e,t,r)=>{Promise.resolve().then(r.bind(r,372))},73474:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(76824).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},31324:(e,t,r)=>{"use strict";var s=r(90567);r.o(s,"redirect")&&r.d(t,{redirect:function(){return s.redirect}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},372:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eu});var s=r(31694),i=r(75542),a=r(94634),o=r(5207),n=r(51010);let c={enter:{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3}},flowPulse:{scale:[1,1.02,1],transition:{duration:2,repeat:1/0,ease:"easeInOut"}},ripple:{scale:[1,1.01,1],opacity:[.9,1,.9],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}},l={ACTIVE_TIME_MIN:25,ACTIVE_TIME_MAX:90,BREAK_INTERVAL:45,CONTEXT_SWITCH_PENALTY:15,TASK_COMPLETION_BONUS:10};class u{static calculateFlowScore(e){return Math.max(0,Math.min(100,50+this.calculateActiveTimeFactor(e.activeTime)*this.SCORE_WEIGHTS.activeTime+e.taskCompletions*l.TASK_COMPLETION_BONUS*this.SCORE_WEIGHTS.taskCompletions-e.contextSwitches*l.CONTEXT_SWITCH_PENALTY*this.SCORE_WEIGHTS.contextSwitches+this.calculateBreakFactor(e.lastBreakTime,e.activeTime)*this.SCORE_WEIGHTS.breakTiming+this.calculateTimeOptimization(e.dayProgress)*this.SCORE_WEIGHTS.timeOptimization))}static determineFlowStatus(e,t){return e>=80&&t.activeTime>=l.ACTIVE_TIME_MIN?"peak":e>=60?"flow":t.activeTime<l.ACTIVE_TIME_MIN?"building":"rest"}static calculateActiveTimeFactor(e){let t=l.ACTIVE_TIME_MAX,r=l.ACTIVE_TIME_MIN;return e<r?e/r*100:e>t?Math.max(0,100-(e-t)/30*10):100}static calculateBreakFactor(e,t){if(!e)return 50;let r=(Date.now()-e.getTime())/6e4,s=l.OPTIMAL_BREAK_INTERVAL;return r<s?100:Math.max(0,100-(r-s)/15*10)}static calculateTimeOptimization(e){for(let t of[{start:.3,end:.45,score:90},{start:.6,end:.75,score:100},{start:.8,end:.9,score:80}])if(e>=t.start&&e<=t.end)return t.score;return 70}static predictFlowTrend(e){if(e.length<2)return"stable";let t=e.slice(-3).map(e=>this.calculateFlowScore(e)),r=t[t.length-1]-t[0];return r>10?"improving":r<-10?"declining":"stable"}static createFlowState(e,t){let r=this.calculateFlowScore(t),s=this.determineFlowStatus(r,t);return{userId:e,score:r,status:s,activeTime:t.activeTime}}}!function(e,t,r){var s;(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(u,"SCORE_WEIGHTS",{activeTime:.3,taskCompletions:.2,contextSwitches:.15,breakTiming:.2,timeOptimization:.15});var d=r(68217),p=r.n(d),m=r(52166);let _={peak:"#50B584",flow:"#3B82F6",rest:"#8B5CF6",building:"#F59E0B"},h={peak:"Peak performance! You're in an optimal flow state.",flow:"You're in flow. Keep the momentum going!",rest:"Time to recharge. Take a short break.",building:"Building focus. Minimize distractions."},f=({score:e,status:t,metrics:r,showDetails:s=!1})=>(0,m.jsxs)(i.E.div,{className:p().flowScore,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},children:[(0,m.jsxs)("div",{className:p().scoreContainer,children:[m.jsx(i.E.div,{className:p().scoreCircle,style:{backgroundColor:_[t],opacity:e/100},animate:{boxShadow:`0 0 ${"peak"===t?"2px":"1px"} ${_[t]}`},children:m.jsx(i.E.div,{className:p().score,animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:e})}),m.jsx("div",{className:p().label,children:"Flow Score"})]}),m.jsx(a.M,{mode:"wait",children:m.jsx(i.E.div,{className:`${p().status} ${p()[t]}`,initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:t.charAt(0).toUpperCase()+t.slice(1)},t)}),s&&(0,m.jsxs)(i.E.div,{className:p().details,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:.3},children:[m.jsx("p",{className:p().description,children:h[t]}),(0,m.jsxs)("div",{className:p().metrics,children:[(0,m.jsxs)("div",{className:p().metric,children:[m.jsx("span",{children:"Active Time"}),(0,m.jsxs)("span",{children:[Math.floor(r.activeTime),"m"]})]}),(0,m.jsxs)("div",{className:p().metric,children:[m.jsx("span",{children:"Tasks Done"}),m.jsx("span",{children:r.taskCompletions})]}),(0,m.jsxs)("div",{className:p().metric,children:[m.jsx("span",{children:"Last Break"}),m.jsx("span",{children:r.lastBreakTime?`${Math.floor((Date.now()-r.lastBreakTime.getTime())/6e4)}m ago`:"N/A"})]})]})]})]}),g=["participants"];function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){w(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function w(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v{static async start(){console.log("Attempting to start/resume flow session...");let{data:{user:e}}=await this.supabase.auth.getUser();if(!e)throw console.error("User not authenticated. Cannot start session."),Error("User not authenticated");let t=e.id;try{let e=await this.getActiveSession(t);if(e){console.log("Resuming existing active session:",e.id),localStorage.setItem(this.ACTIVE_SESSION_KEY,JSON.stringify(e));let{data:r,error:s}=await this.supabase.from(this.FLOW_STATES_TABLE).select("*").eq("user_id",t).single();if(s||!r)return console.error("Error fetching current flow state for resuming session:",s),{initialState:{score:0,status:"rest",activeTime:0,interruptions:0,taskCompletions:0}};let i={score:r.score,status:r.status,activeTime:r.active_time,interruptions:r.interruptions||0,taskCompletions:r.task_completions||0};return console.log("Resumed with current state:",i),{initialState:i}}{console.log("No active session found, creating a new one.");let r={score:50,status:"building",activeTime:0,interruptions:0,taskCompletions:0},s={userId:t,initialState:r,type:"focus",settings:this.getDefaultSettings()};e=await this.create(s);let{error:i}=await this.supabase.from(this.FLOW_STATES_TABLE).upsert({user_id:t,score:r.score,status:r.status,active_time:r.activeTime,interruptions:r.interruptions,task_completions:r.taskCompletions,updated_at:new Date().toISOString()},{onConflict:"user_id"});return i&&console.error("Error upserting initial flow state:",i),console.log("New session created and initial state saved:",e),{initialState:r}}}catch(e){return console.error("Error in FlowSessionService.start:",e),{initialState:{score:0,status:"rest",activeTime:0,interruptions:0,taskCompletions:0}}}}static async create(e){let t={id:crypto.randomUUID(),userId:e.userId,teamId:e.teamId,startTime:new Date,initialState:e.initialState,participants:new Set([e.userId]),type:e.type||"focus",settings:e.settings||this.getDefaultSettings()},r={id:t.id,user_id:e.userId,team_id:e.teamId,start_time:t.startTime.toISOString(),initial_state:e.initialState,type:t.type,settings:t.settings},{error:s}=await this.supabase.from(this.SESSION_TABLE).insert(r);if(s)throw s;return localStorage.setItem(this.ACTIVE_SESSION_KEY,JSON.stringify(t)),t}static async end(e,t){console.log(`Ending session: ${e}`);let r=new Date,s={sessionId:e,duration:this.calculateDuration(t.startTime,r),flowScore:this.calculateAverageFlow(t.transitions),productivity:this.calculateProductivity(t),insights:this.generateInsights(t)},{error:i}=await this.supabase.from(this.SESSION_TABLE).update({end_time:r.toISOString(),summary:s}).eq("id",e);if(i)throw i;return localStorage.removeItem(this.ACTIVE_SESSION_KEY),console.log(`Session ${e} ended. Summary:`,s),s}static async getActiveSession(e){console.log(`Checking active session for user: ${e}`);let t=localStorage.getItem(this.ACTIVE_SESSION_KEY);if(t)try{let r=JSON.parse(t);if(r.startTime&&(r.startTime=new Date(r.startTime)),Array.isArray(r.participants)?r.participants=new Set(r.participants):r.participants=new Set([e]),r.id&&r.startTime&&r.participants&&r.userId===e)return r;localStorage.removeItem(this.ACTIVE_SESSION_KEY)}catch(e){localStorage.removeItem(this.ACTIVE_SESSION_KEY)}let{data:r,error:s}=await this.supabase.from(this.SESSION_TABLE).select("*").eq("user_id",e).is("end_time",null).maybeSingle();if(s)return console.error("Error fetching active session from DB:",s),null;if(r){let t={id:r.id,userId:r.user_id,teamId:r.team_id,startTime:new Date(r.start_time),participants:new Set([e]),type:r.type||"focus",initialState:r.initial_state||void 0,settings:r.settings||void 0};return localStorage.setItem(this.ACTIVE_SESSION_KEY,JSON.stringify(t)),t}return null}static async recordInterruption(e,t){console.warn(`Recording interruption: ${e}, Recovery: ${t}ms`);let{data:{user:r}}=await this.supabase.auth.getUser();if(!r)throw Error("User not authenticated");let s=r.id,i=await this.getActiveSession(s);if(!i||!i.id)return console.error("Cannot record interruption: No active session found."),Promise.resolve({score:0,status:"rest",activeTime:0,interruptions:0,taskCompletions:0});let a=i.id;console.log(`TODO: Insert interruption record (Session: ${a}, Type: ${e})`);let{data:o,error:n}=await this.supabase.from(this.FLOW_STATES_TABLE).select("score, status, interruptions, active_time, task_completions").eq("user_id",s).single();if(n||!o)return console.error("Error fetching current flow state for interruption:",n),Promise.resolve({score:40,status:"rest",activeTime:0,interruptions:1,taskCompletions:0});let c=Math.max(0,o.score-t/6e4*5),l=(o.interruptions||0)+1,u={score:c,status:"rest",activeTime:o.active_time,interruptions:l,taskCompletions:o.task_completions||0},{error:d}=await this.supabase.from(this.FLOW_STATES_TABLE).update({score:u.score,status:u.status,interruptions:u.interruptions,updated_at:new Date().toISOString()}).eq("user_id",s);if(d)return console.error("Error updating flow_states after interruption:",d),Promise.resolve({score:o.score,status:o.status,activeTime:o.active_time,interruptions:o.interruptions||0,taskCompletions:o.task_completions||0});let p=JSON.parse(localStorage.getItem(this.ACTIVE_SESSION_KEY)||"{}");return localStorage.setItem(this.ACTIVE_SESSION_KEY,JSON.stringify(S({},p))),console.log("Interruption recorded, updated state:",u),Promise.resolve(u)}static calculateProductivity(e){if(!e||!Array.isArray(e.transitions))return 0;let t=e.transitions.reduce((e,t)=>e+(t?.duration||0),0);return 0===t?0:Math.round(e.transitions.filter(e=>e&&("flow"===e.to||"peak"===e.to)).reduce((e,t)=>e+(t?.duration||0),0)/t*100)}static getDefaultSettings(){return{}}static prepareSessionData(e){let{participants:t}=e;return S({},function(e,t){if(null==e)return{};var r,s,i=function(e,t){if(null==e)return{};var r,s,i={},a=Object.keys(e);for(s=0;s<a.length;s++)r=a[s],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)r=a[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,g))}static calculateDuration(e,t){let r="string"==typeof e?new Date(e).getTime():e.getTime();return Math.max(0,("string"==typeof t?new Date(t).getTime():t.getTime())-r)}static calculateAverageFlow(e){return 50}static generateInsights(e){return{}}}w(v,"ACTIVE_SESSION_KEY","activeFlowSession"),w(v,"SESSION_TABLE","flow_sessions"),w(v,"FLOW_STATES_TABLE","flow_states"),w(v,"INTERRUPTIONS_TABLE","flow_interruptions"),w(v,"supabase",n.OQ);let k=null;function T(){console.log("stopMetricsTracking called (basic implementation)"),k&&(clearInterval(k),k=null),console.log("Metrics tracking stopped.")}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(t){var s,i;s=t,i=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[s]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let j=["completion_metrics"];function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){I(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function I(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let C={priority:50,flow_optimal:!1,context_cost:0,completed:!1,status:"active",completion_metrics:{progress:0}};function N(e,t,r){return e?Math.min(1,Math.max(0,(e.project_id===t.project_id?.1:.4)*(1+(50-r.score)/50))):0}async function P(e){let{error:t}=await n.OQ.from("tasks").delete().eq("id",e);if(t)throw console.error("Error deleting task:",t),t}async function A(e){let{data:t,error:r}=await n.OQ.from("tasks").select("*").eq("id",e).single();return r?(console.error("Error getting task:",r),null):t}class F{constructor(e){this.userId=e}async getUserTasks(e){let t=n.OQ.from("tasks").select("*").eq("user_id",this.userId).in("status",["active","completed","archived"]);e&&(t=t.eq("team_id",e));let{data:r,error:s}=await t.order("created_at",{ascending:!1});return s?(console.error("Error fetching user tasks:",s),[]):r||[]}async createTask(e){let t=E(E(E({},C),e),{},{status:e.status||"active",user_id:this.userId,priority:e.priority??C.priority,flow_optimal:e.flowOptimal??C.flow_optimal,context_cost:e.context_cost??C.context_cost,estimated_duration:e.estimated_duration});Object.keys(t).forEach(e=>void 0===t[e]&&delete t[e]);let{data:r,error:s}=await n.OQ.from("tasks").insert(t).select().single();if(s)throw console.error("Error in TaskFlowService.createTask:",s),s;if(!r)throw Error("Task creation returned no data.");return r}async updateTaskFlowMetrics(e,t){let r=await A(e);if(!r)throw Error(`Task not found: ${e}`);let s=r.estimated_duration??0,i=r.completion_metrics||{},a=(t.flowScore??i.flowScore??0)>=70&&(t.completionTime??i.completionTime??1/0)<=s,o=E(E({},i),{},{flowScore:t.flowScore??i.flowScore,completionTime:t.completionTime??i.completionTime,progress:t.progress??i.progress,lastNote:t.lastNote??i.lastNote,lastUpdate:new Date().toISOString()}),{error:c}=await n.OQ.from("tasks").update({flow_optimal:a,completion_metrics:o}).eq("id",e);if(c)throw console.error(`Failed to update task metrics for ${e}:`,c),c}async updateTask(e,t){let{completion_metrics:r}=t,s=function(e,t){if(null==e)return{};var r,s,i=function(e,t){if(null==e)return{};var r,s,i={},a=Object.keys(e);for(s=0;s<a.length;s++)r=a[s],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)r=a[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(t,j);if(Object.keys(s).length>0){let{error:t}=await n.OQ.from("tasks").update(s).eq("id",e);if(t)throw console.error(`Failed to update task fields for ${e}:`,t),t}r&&await this.updateTaskFlowMetrics(e,r);let i=await A(e);if(!i)throw Error(`Failed to refetch updated task ${e}`);return i}subscribeToTaskUpdates(e,t){let r=n.OQ.channel(`public:tasks:user=${this.userId}`);return r.on("postgres_changes",{event:"*",schema:"public",table:"tasks",filter:`user_id=eq.${this.userId}`},e=>{console.log("Task change received!",e),t()}).subscribe((e,t)=>{"SUBSCRIBED"===e&&console.log("Subscribed to task updates for user:",this.userId),"CHANNEL_ERROR"===e&&console.error("Task subscription error:",t),"TIMED_OUT"===e&&console.warn("Task subscription timed out.")}),r}static calculateTaskPriority(e,t){let r=e.priority;"peak"===t.currentFlowState.status?r+=this.FLOW_OPTIMAL_BONUS:"rest"===t.currentFlowState.status&&(r-=10),t.previousTaskId&&(e.context_cost??0)>this.CONTEXT_SWITCH_THRESHOLD&&(r-=this.TASK_SWITCH_PENALTY*(e.context_cost??0));let s=Math.max(90-t.activeTaskTime,0);return(e.estimated_duration??30)>s&&(r-=15),Math.max(0,Math.min(100,r))}static async getOptimalTasks(e,t){let{data:r,error:s}=await n.OQ.from("tasks").select("*").eq("user_id",e).eq("status","active").order("priority",{ascending:!1});if(s)throw s;let i={currentFlowState:t,activeTaskTime:t.activeTime,taskSwitches:0};return r?r.map(e=>E(E({},e),{},{priority:this.calculateTaskPriority(e,i)})).sort((e,t)=>t.priority-e.priority):[]}}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){var s,i;s=t,i=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[s]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}I(F,"CONTEXT_SWITCH_THRESHOLD",.3),I(F,"FLOW_OPTIMAL_BONUS",20),I(F,"TASK_SWITCH_PENALTY",15),I(F,"calculateContextSwitch",N),I(F,"suggestBreak",function(e){return e.activeTime>90||e.score<40||"rest"===e.status}),I(F,"predictTaskSuccess",function(e,t){return Math.max(0,Math.min(1,t.score/100*Math.min(1,(90-t.activeTime)/(e.estimated_duration||30))*(1-.5*(e.context_cost||0))))});let B=e=>({id:e.id,title:e.title,description:e.description,status:e.status,createdAt:e.created_at,userId:e.user_id,priority:e.priority,flowOptimal:e.flow_optimal,contextCost:e.context_cost,completed:e.completed,completionMetrics:e.completion_metrics,estimatedDuration:e.estimated_duration,teamId:e.team_id,projectId:e.project_id,dueDate:e.due_date??void 0});function q({userId:e,teamId:t}){let{0:r,1:i}=(0,s.useState)([]),{0:a,1:o}=(0,s.useState)(!0),{0:n,1:c}=(0,s.useState)(null),{0:l,1:u}=(0,s.useState)(null),{flowState:d}=function(){let{0:e,1:t}=(0,s.useState)({score:0,status:"rest",activeTime:0,interruptions:0,taskCompletions:0}),{0:r,1:i}=(0,s.useState)({activeTime:0,interruptions:0,taskCompletions:0,contextSwitches:0,interruptedTime:0,dayProgress:function(){let e=new Date,t=new Date(e);t.setHours(9,0,0,0);let r=new Date(e);r.setHours(17,0,0,0);let s=r.getTime()-t.getTime(),i=e.getTime()-t.getTime();return s<=0?0:Math.max(0,Math.min(1,i/s))}(),lastBreakTime:void 0}),{0:a,1:o}=(0,s.useState)(null),n=(0,s.useCallback)(async()=>{try{let e=await v.start();t(e.initialState),o(Date.now()),console.log("startMetricsTracking called (basic implementation)"),k&&clearInterval(k),Date.now(),console.log("Metrics tracking started.")}catch(e){console.error("Failed to start flow session:",e)}},[]),c=(0,s.useCallback)(async()=>{try{let r=localStorage.getItem("activeFlowSession"),s=r?JSON.parse(r):{},i=s?.id||"unknown-session",n={startTime:new Date(a||s?.startTime||Date.now()),transitions:[],taskCompletions:e.taskCompletions};await v.end(i,n),t(e=>x(x({},e),{},{status:"rest"})),o(null),T()}catch(e){console.error("Failed to end flow session:",e),t(e=>x(x({},e),{},{status:"rest"})),o(null),T()}},[e.taskCompletions,a]);return{flowState:e,metrics:r,startFlowSession:n,endFlowSession:c,recordInterruption:(0,s.useCallback)(async(e,r)=>{try{let s=await v.recordInterruption(e,r);t(s),i(e=>x(x({},e),{},{interruptions:e.interruptions+1,interruptedTime:e.interruptedTime+r/6e4}))}catch(e){console.error("Failed to record interruption:",e)}},[])}}(),p=(0,s.useMemo)(()=>new F(e),[e]),m=(0,s.useCallback)(async()=>{o(!0);try{c(null);let e=await p.getUserTasks(t);i(e.map(B))}catch(e){console.error("Error fetching tasks:",e),i([]),c(e instanceof Error?e:Error("Failed to fetch tasks"))}finally{o(!1)}},[p,t]),_=(0,s.useCallback)(async t=>{try{c(null);let r={id:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),user_id:e,title:t.title,description:t.description??null,priority:t.priority??50,flow_optimal:t.flow_optimal??!1,context_cost:t.context_cost??0,estimated_duration:t.estimated_duration,completed:!1,team_id:t.team_id??null,project_id:t.project_id??null,due_date:t.due_date??null,status:t.status??"active",completion_metrics:t.completion_metrics??{progress:0}},s=N(null,r,d),a=M(M({},t),{},{context_cost:s}),o=await p.createTask(a),n=B(o);return i(e=>[...e,n]),n}catch(e){throw console.error("useFlowTasks: Error creating task:",e),c(e instanceof Error?e:Error("Failed to create task")),e}},[p,d,e]),h=(0,s.useCallback)(async(e,t)=>{try{c(null);let r=await p.updateTask(e,t),s=B(r);return i(t=>t.map(t=>t.id===e?s:t)),s}catch(e){throw console.error("useFlowTasks: Error updating task:",e),c(e instanceof Error?e:Error("Failed to update task")),e}},[p]),f=(0,s.useCallback)(async e=>{try{c(null),await P(e),i(t=>t.filter(t=>t.id!==e))}catch(e){throw console.error("useFlowTasks: Error deleting task:",e),c(e instanceof Error?e:Error("Failed to delete task")),e}},[]);return{tasks:r,loading:a,createTask:_,error:n,updateTask:h,activeTaskId:l,switchTask:(0,s.useCallback)(e=>{u(e),console.log(`Switched active task to: ${e}`)},[]),completeTask:(0,s.useCallback)(async e=>{i(t=>t.map(t=>t.id===e?M(M({},t),{},{completed:!0,status:"completed"}):t)),u(null);try{await p.updateTask(e,{completed:!0,status:"completed"}),console.log(`Task marked as complete: ${e}`)}catch(e){console.error("Failed to mark task as complete on server",e)}},[p]),deleteTask:f,refreshTasks:m,shouldTakeBreak:(0,s.useCallback)(()=>d.activeTime>90||d.score<40,[d.activeTime,d.score])}}var L=r(76824);let R=(0,L.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),H=(0,L.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),G=(0,L.Z)("ArrowRightCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);var $=r(51327),V=r.n($);let U=({task:e,isActive:t,onSelect:r,onComplete:a})=>{let{flowState:n}=(0,o.G2)(),c=(0,s.useMemo)(()=>{let r=e.successProbability??F.predictTaskSuccess(e,n);return{isOptimal:"peak"===n.status||"flow"===n.status,probability:r,contextWarning:!t&&e.contextCost>.3,breakNeeded:F.suggestBreak(n)}},[e,n,t]);return(0,m.jsxs)(i.E.div,{className:`
        ${V().taskItem}
        ${t?V().active:""}
        ${e.completed?V().completed:""}
        ${c.isOptimal?V().optimal:""}
      `,onClick:()=>{r&&!e.completed&&r(e.id)},initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,m.jsxs)("div",{className:V().header,children:[m.jsx("h3",{className:V().title,children:e.title}),!e.completed&&m.jsx(i.E.button,{className:V().completeButton,onClick:t=>{t.stopPropagation(),a&&!e.completed&&a(e.id)},whileHover:{scale:1.1},whileTap:{scale:.9},children:m.jsx(R,{className:V().icon})})]}),e.description&&m.jsx("p",{className:V().description,children:e.description}),(0,m.jsxs)("div",{className:V().metrics,children:[(0,m.jsxs)("div",{className:V().metric,children:[m.jsx("span",{children:"Est. Duration"}),(0,m.jsxs)("span",{children:[e.estimatedDuration,"m"]})]}),(0,m.jsxs)("div",{className:V().metric,children:[m.jsx("span",{children:"Success Rate"}),(0,m.jsxs)("span",{className:`
            ${c.probability>=.7?V().high:""}
            ${c.probability<.7&&c.probability>=.4?V().medium:""}
            ${c.probability<.4?V().low:""}
          `,children:[Math.round(100*c.probability),"%"]})]}),!t&&c.contextWarning&&(0,m.jsxs)("div",{className:V().warning,children:[m.jsx(H,{className:V().icon}),m.jsx("span",{children:"High context switch cost"})]})]}),c.breakNeeded&&t&&(0,m.jsxs)("div",{className:V().breakSuggestion,children:[m.jsx(H,{className:V().icon}),m.jsx("span",{children:"Break recommended before continuing"})]}),t&&(0,m.jsxs)(i.E.div,{className:V().flowStatus,animate:{scale:[1,1.05,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0},children:[(0,m.jsxs)("div",{className:V().statusIndicator,children:[m.jsx(G,{className:V().icon}),m.jsx("span",{children:"In Progress"})]}),(0,m.jsxs)("div",{className:V().flowScore,children:["Flow Score: ",n.score]})]})]})};var W=r(58339),Y=r(73474);let K=(0,L.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var Z=r(7687),Q=r(83135),z=r.n(Q);let X=({userId:e,teamId:t,onCreated:r})=>{let{0:a,1:n}=(0,s.useState)(!1),{0:c,1:l}=(0,s.useState)(""),{0:u,1:d}=(0,s.useState)(""),{0:p,1:_}=(0,s.useState)(30),{flowState:h}=(0,o.G2)(),{createTask:f}=q({userId:e,teamId:t}),{toast:g}=(0,Z.p)(),y=async s=>{s.preventDefault();try{let s=F.calculateContextSwitch("","new",h),i={title:c,description:u,estimatedDuration:p,userId:e,teamId:t,contextCost:s,priority:C.priority,flowOptimal:C.flowOptimal,status:C.status};await f(i),l(""),d(""),_(30),n(!1),r?.()}catch(e){console.error("Error creating task:",e),g({title:"Error creating task",description:"Please try again later",variant:"destructive"})}},S=(0,s.useCallback)(()=>"peak"===h.status?{message:"Consider shorter tasks to maintain peak flow",type:"warning"}:"flow"===h.status?{message:"Good time to plan next tasks",type:"success"}:"rest"===h.status?{message:"Good time for task planning and organization",type:"info"}:{message:"Building focus - keep tasks manageable",type:"info"},[h.status])();return m.jsx(i.E.div,{className:z().taskCreate,initial:!1,animate:{height:a?"auto":"48px"},children:a?(0,m.jsxs)("form",{onSubmit:y,className:z().createForm,children:[(0,m.jsxs)("div",{className:z().header,children:[m.jsx("h3",{children:"Create New Task"}),m.jsx("button",{type:"button",className:z().closeButton,onClick:()=>n(!1),children:"✕"})]}),(0,m.jsxs)("div",{className:z().advice,"data-type":S.type,children:[m.jsx(H,{className:z().icon}),m.jsx("span",{children:S.message})]}),(0,m.jsxs)("div",{className:z().field,children:[m.jsx("label",{htmlFor:"title",children:"Title"}),m.jsx("input",{id:"title",type:"text",value:c,onChange:e=>l(e.target.value),placeholder:"Task title",required:!0})]}),(0,m.jsxs)("div",{className:z().field,children:[m.jsx("label",{htmlFor:"description",children:"Description"}),m.jsx("textarea",{id:"description",value:u,onChange:e=>d(e.target.value),placeholder:"Task description (optional)",rows:3})]}),(0,m.jsxs)("div",{className:z().field,children:[(0,m.jsxs)("label",{htmlFor:"duration",children:[m.jsx(Y.Z,{className:z().icon}),"Estimated Duration (minutes)"]}),m.jsx("input",{id:"duration",type:"number",min:5,max:180,step:5,value:p,onChange:e=>_(Number(e.target.value)),required:!0})]}),(0,m.jsxs)("div",{className:z().actions,children:[m.jsx("button",{type:"button",className:z().cancelButton,onClick:()=>n(!1),children:"Cancel"}),(0,m.jsxs)("button",{type:"submit",className:z().submitButton,disabled:!c||p<5,children:["Create Task",m.jsx(K,{className:z().icon})]})]})]}):(0,m.jsxs)("button",{className:z().createButton,onClick:()=>n(!0),children:[m.jsx(W.Z,{className:z().icon}),m.jsx("span",{children:"Create New Task"})]})})};var J=r(9414),ee=r.n(J);let et=({userId:e,teamId:t})=>{let{flowState:r}=(0,o.G2)(),{tasks:s,loading:n,error:c,activeTaskId:l,switchTask:u,completeTask:d,shouldTakeBreak:p}=q({userId:e,teamId:t});if(n)return(0,m.jsxs)("div",{className:ee().loading,children:[m.jsx("div",{className:ee().pulse}),m.jsx("span",{children:"Loading tasks..."})]});if(c)return(0,m.jsxs)("div",{className:ee().error,children:[(0,m.jsxs)("p",{children:["Error loading tasks: ",c.message]}),m.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]});let _=p(),h=s.filter(e=>!e.completed),f=s.filter(e=>e.completed);return(0,m.jsxs)("div",{className:ee().tasksContainer,children:[m.jsx(X,{userId:e,teamId:t}),_&&(0,m.jsxs)(i.E.div,{className:ee().breakSuggestion,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[m.jsx("h3",{children:"Break Suggested"}),m.jsx("p",{children:r.activeTime>90?"You've been working for a while. Take a short break to maintain productivity.":"Your flow score indicates it's a good time for a break."})]}),m.jsx("div",{className:ee().tasksList,children:(0,m.jsxs)(a.M,{mode:"popLayout",children:[h.length>0?(0,m.jsxs)(m.Fragment,{children:[m.jsx("h2",{className:ee().sectionTitle,children:"Active Tasks"}),h.map(e=>m.jsx(U,{task:e,isActive:e.id===l,onSelect:u,onComplete:d},e.id))]}):m.jsx(i.E.div,{className:ee().emptyState,initial:{opacity:0},animate:{opacity:1},children:m.jsx("p",{children:"No active tasks. Create a new task to get started!"})}),f.length>0&&(0,m.jsxs)(m.Fragment,{children:[m.jsx("h2",{className:ee().sectionTitle,children:"Completed Tasks"}),m.jsx("div",{className:ee().completedTasks,children:f.map(e=>m.jsx(U,{task:e,isActive:!1},e.id))})]})]})}),t&&s.length>0&&(0,m.jsxs)("div",{className:ee().teamStats,children:[m.jsx("h3",{children:"Team Progress"}),(0,m.jsxs)("div",{className:ee().statsGrid,children:[(0,m.jsxs)("div",{className:ee().stat,children:[m.jsx("span",{children:"Active Tasks"}),m.jsx("span",{children:h.length})]}),(0,m.jsxs)("div",{className:ee().stat,children:[m.jsx("span",{children:"Completed Today"}),m.jsx("span",{children:f.length})]}),(0,m.jsxs)("div",{className:ee().stat,children:[m.jsx("span",{children:"Team Flow Score"}),m.jsx("span",{children:Math.round(r.score)})]})]})]})]})};var er=r(95186),es=r(71409),ei=r(10633),ea=r.n(ei);function eo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function en(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(r),!0).forEach(function(t){var s,i;s=t,i=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[s]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ec=({initialTeamId:e})=>{let{flowState:t,updateFlowState:r}=(0,o.G2)(),{team:l}=(0,es.t)(t.userId),d=e||l?.id;if((0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await n.OQ.auth.getUser();if(!e)return;let t={activeTime:0,taskCompletions:0,contextSwitches:0,dayProgress:new Date().getHours()/24};r(en(en({},u.createFlowState(e.id,t)),{},{userId:e.id,lastUpdated:new Date().toISOString()}))})()},[r]),!t.userId)return null;let p={activeTime:t.activeTime,taskCompletions:0,contextSwitches:0,dayProgress:new Date().getHours()/24};return m.jsx(i.E.div,{className:ea().flowContainer,initial:"initial",animate:"animate",variants:c.enter,children:(0,m.jsxs)(a.M,{children:[m.jsx(i.E.div,{className:ea().flowScoreCard,animate:c.flowPulse,children:m.jsx(f,{score:t.score,status:t.status,metrics:p,showDetails:!0})}),t.userId&&m.jsx(i.E.div,{className:ea().taskStream,variants:c.enter,children:m.jsx(et,{userId:t.userId,teamId:d})}),m.jsx(i.E.div,{className:ea().teamSyncCard,animate:c.ripple,children:d&&m.jsx(er.F,{teamId:d,currentUserId:t.userId})})]})})};var el=r(31324);function eu(){let{session:e}=(0,n.$4)();return e||(0,el.redirect)("/auth/signin"),(0,m.jsxs)("main",{children:[m.jsx(X,{userId:e.user.id}),m.jsx(ec,{})]})}},10633:e=>{e.exports={flowContainer:"FlowStateApp_flowContainer__LsY8w",flowScoreCard:"FlowStateApp_flowScoreCard__WIH7x FlowStateApp_glassPanel__27jot",taskStream:"FlowStateApp_taskStream__Itg82",teamSyncCard:"FlowStateApp_teamSyncCard___CLU1 FlowStateApp_glassPanel__27jot",enter:"FlowStateApp_enter__u0VSO",enterActive:"FlowStateApp_enterActive__Ryjhw",exit:"FlowStateApp_exit__DOGQQ",exitActive:"FlowStateApp_exitActive__utRcZ",glassPanel:"FlowStateApp_glassPanel__27jot"}},51327:e=>{e.exports={taskItem:"TaskItem_taskItem__oCSLJ",active:"TaskItem_active__HlHOQ",completed:"TaskItem_completed__CVYAi",optimal:"TaskItem_optimal__csgKa",header:"TaskItem_header__qN2Z_",title:"TaskItem_title__epY1j",description:"TaskItem_description__IVBam",completeButton:"TaskItem_completeButton__BjRVT",metrics:"TaskItem_metrics__HlX_w",metric:"TaskItem_metric__7T9i5",high:"TaskItem_high__mrbOC",medium:"TaskItem_medium__pGFIy",low:"TaskItem_low__8yToT",warning:"TaskItem_warning__bY3AZ",breakSuggestion:"TaskItem_breakSuggestion__t5Nid",icon:"TaskItem_icon__3opqs",flowStatus:"TaskItem_flowStatus__n0Ty_",statusIndicator:"TaskItem_statusIndicator__9yCKq",flowScore:"TaskItem_flowScore__pt3Sj"}},9414:e=>{e.exports={tasksContainer:"styles_tasksContainer__ZSh27",loading:"styles_loading__084Mk",pulse:"styles_pulse__oen3g",error:"styles_error__dgukj",breakSuggestion:"styles_breakSuggestion__vXhkX",tasksList:"styles_tasksList__nU6Wo",sectionTitle:"styles_sectionTitle__r2mWu",emptyState:"styles_emptyState__6k1vK",completedTasks:"styles_completedTasks__k_5Xm",teamStats:"styles_teamStats__boN8J",statsGrid:"styles_statsGrid__j042A",stat:"styles_stat__Ixv_t",taskEnter:"styles_taskEnter__k4Ty7",taskEnterActive:"styles_taskEnterActive__DuHHz",taskExit:"styles_taskExit__CdLTI",taskExitActive:"styles_taskExitActive__NAiRJ"}},68217:e=>{e.exports={flowScore:"FlowScore_flowScore__UVsS0",scoreContainer:"FlowScore_scoreContainer__ZOCAB",scoreCircle:"FlowScore_scoreCircle__AyOCF",score:"FlowScore_score__MD3Gz",label:"FlowScore_label__fraGm",status:"FlowScore_status__lWg2c",peak:"FlowScore_peak__pAQuk",flow:"FlowScore_flow__Ge1tI",rest:"FlowScore_rest__Yq2R4",building:"FlowScore_building___pNhO",details:"FlowScore_details__qmdhf",description:"FlowScore_description__Z_ZIS",metrics:"FlowScore_metrics___Hmu9",metric:"FlowScore_metric__kddDH"}},83135:e=>{e.exports={taskCreate:"Task_taskCreate__lXShc",createButton:"Task_createButton__2F51N",createForm:"Task_createForm__R0Os5",header:"Task_header__qGNTr",closeButton:"Task_closeButton__VUdZF",advice:"Task_advice__n9e4m",slideIn:"Task_slideIn__lwSv3",field:"Task_field__kyLSM",actions:"Task_actions__6DJVV",cancelButton:"Task_cancelButton__boqQG",submitButton:"Task_submitButton__00jKO",icon:"Task_icon__O5nEZ",expandForm:"Task_expandForm___YG8M"}},12283:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(87866).createProxy)(String.raw`C:\Bollo\Github\flowstate-catalyst\src\app\page.tsx#default`)}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[237,479,494,679,862,379,965,223],()=>r(58011));module.exports=s})();