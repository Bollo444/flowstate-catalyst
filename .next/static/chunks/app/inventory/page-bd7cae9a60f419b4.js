(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1268],{4195:function(e,r,t){Promise.resolve().then(t.bind(t,908))},8969:function(e,r,t){"use strict";t.d(r,{Z:function(){return x}});var n=t(5387),a=t(7110),s=t(4513),o=t(3366),c=t(6871),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},u=["color","size","strokeWidth","absoluteStrokeWidth","className","children"];function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach(function(r){(0,s.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var x=function(e,r){var t=(0,c.forwardRef)(function(t,s){var d=t.color,x=t.size,p=void 0===x?24:x,m=t.strokeWidth,h=void 0===m?2:m,f=t.absoluteStrokeWidth,g=t.className,b=t.children,y=(0,o.Z)(t,u);return(0,c.createElement)("svg",l(l({ref:s},i),{},{width:p,height:p,stroke:void 0===d?"currentColor":d,strokeWidth:f?24*Number(h)/Number(p):h,className:["lucide","lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()),void 0===g?"":g].join(" ")},y),[].concat((0,a.Z)(r.map(function(e){var r=(0,n.Z)(e,2),t=r[0],a=r[1];return(0,c.createElement)(t,a)})),(0,a.Z)(Array.isArray(b)?b:[b])))});return t.displayName="".concat(e),t}},6314:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(8969).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5984:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(8969).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7435:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(8969).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},908:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return w}});var n=t(6871),a=t(5387),s=t(90),o=t(5977),c=t.n(o),i=t(8839),u=t(5685),d=t(26),l=function(){var e,r,t,n,a,o,l,x,p,m,h,f,g,b,y,v,k,w;function j(e){(0,u.Z)(this,j),this.userId=e}return(0,d.Z)(j,[{key:"getProducts",value:(e=(0,s.Z)(c().mark(function e(){var r,t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("products").select("*").order("name");case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=8;break}return console.error("Error fetching products:",n),e.abrupt("return",[]);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})},{key:"getProductById",value:(r=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("products").select("*").eq("id",r).single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error fetching product:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})},{key:"createProduct",value:(t=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("products").insert([r]).select().single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error creating product:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},{key:"updateProduct",value:(n=(0,s.Z)(c().mark(function e(r,t){var n,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("products").update(t).eq("id",r).select().single();case 2:if(a=(n=e.sent).data,!(s=n.error)){e.next=8;break}return console.error("Error updating product:",s),e.abrupt("return",null);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)})),function(e,r){return n.apply(this,arguments)})},{key:"deleteProduct",value:(a=(0,s.Z)(c().mark(function e(r){var t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("products").delete().eq("id",r);case 2:if(!(t=e.sent.error)){e.next=7;break}return console.error("Error deleting product:",t),e.abrupt("return",!1);case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)})},{key:"getStockLocations",value:(o=(0,s.Z)(c().mark(function e(){var r,t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("stock_locations").select("*").order("name");case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=8;break}return console.error("Error fetching stock locations:",n),e.abrupt("return",[]);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}},e)})),function(){return o.apply(this,arguments)})},{key:"getStockLocationById",value:(l=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("stock_locations").select("*").eq("id",r).single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error fetching stock location:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return l.apply(this,arguments)})},{key:"createStockLocation",value:(x=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("stock_locations").insert([r]).select().single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error creating stock location:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return x.apply(this,arguments)})},{key:"updateStockLocation",value:(p=(0,s.Z)(c().mark(function e(r,t){var n,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("stock_locations").update(t).eq("id",r).select().single();case 2:if(a=(n=e.sent).data,!(s=n.error)){e.next=8;break}return console.error("Error updating stock location:",s),e.abrupt("return",null);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)})),function(e,r){return p.apply(this,arguments)})},{key:"getInventoryItems",value:(m=(0,s.Z)(c().mark(function e(r,t){var n,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.OQ.from("inventory_items").select("*"),r&&(n=n.eq("product_id",r)),t&&(n=n.eq("location_id",t)),e.next=5,n;case 5:if(s=(a=e.sent).data,!(o=a.error)){e.next=11;break}return console.error("Error fetching inventory items:",o),e.abrupt("return",[]);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}},e)})),function(e,r){return m.apply(this,arguments)})},{key:"getInventoryItemById",value:(h=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("inventory_items").select("*").eq("id",r).single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error fetching inventory item:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return h.apply(this,arguments)})},{key:"createInventoryItem",value:(f=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("inventory_items").insert([r]).select().single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error creating inventory item:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),function(e){return f.apply(this,arguments)})},{key:"updateInventoryItem",value:(g=(0,s.Z)(c().mark(function e(r,t){var n,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.from("inventory_items").update(t).eq("id",r).select().single();case 2:if(a=(n=e.sent).data,!(s=n.error)){e.next=8;break}return console.error("Error updating inventory item:",s),e.abrupt("return",null);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)})),function(e,r){return g.apply(this,arguments)})},{key:"getStockMovements",value:(b=(0,s.Z)(c().mark(function e(r,t){var n,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.OQ.from("stock_movements").select("*").order("created_at",{ascending:!1}),r&&(n=n.eq("product_id",r)),t&&(n=n.eq("movement_type",t)),e.next=5,n;case 5:if(s=(a=e.sent).data,!(o=a.error)){e.next=11;break}return console.error("Error fetching stock movements:",o),e.abrupt("return",[]);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}},e)})),function(e,r){return b.apply(this,arguments)})},{key:"createStockMovement",value:(y=(0,s.Z)(c().mark(function e(r){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.rpc("create_stock_movement",{p_product_id:r.product_id,p_source_location_id:r.source_location_id,p_destination_location_id:r.destination_location_id,p_quantity:r.quantity,p_movement_type:r.movement_type,p_reference_number:r.reference_number,p_notes:r.notes,p_performed_by:this.userId});case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=8;break}return console.error("Error creating stock movement:",a),e.abrupt("return",null);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"getLowStockAlerts",value:(v=(0,s.Z)(c().mark(function e(){var r,t,n,a,s=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>0&&void 0!==s[0]&&s[0],e.next=3,i.OQ.from("low_stock_alerts").select("*").eq("is_resolved",r).order("created_at",{ascending:!1});case 3:if(n=(t=e.sent).data,!(a=t.error)){e.next=9;break}return console.error("Error fetching low stock alerts:",a),e.abrupt("return",[]);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}},e)})),function(){return v.apply(this,arguments)})},{key:"resolveLowStockAlert",value:(k=(0,s.Z)(c().mark(function e(r){var t,n,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={is_resolved:r.is_resolved,resolved_at:r.is_resolved?new Date().toISOString():null},e.next=3,i.OQ.from("low_stock_alerts").update(t).eq("id",r.id).select().single();case 3:if(a=(n=e.sent).data,!(s=n.error)){e.next=9;break}return console.error("Error resolving low stock alert:",s),e.abrupt("return",null);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}},e)})),function(e){return k.apply(this,arguments)})},{key:"checkAndGenerateLowStockAlerts",value:(w=(0,s.Z)(c().mark(function e(){var r,t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.OQ.rpc("generate_low_stock_alerts");case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=8;break}return console.error("Error generating low stock alerts:",n),e.abrupt("return",0);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}},e)})),function(){return w.apply(this,arguments)})}]),j}(),x=t(8969),p=(0,x.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),m=(0,x.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),h=t(6314),f=t(7435),g=t(5984),b=t(7437),y=function(){var e,r=(0,i.$4)().session,t=null==r?void 0:r.user,o=(0,n.useState)([]),u=o[0],d=o[1],x=(0,n.useState)([]),y=x[0],v=x[1],k=(0,n.useState)([]),w=(k[0],k[1]),j=(0,n.useState)([]),N=j[0],_=j[1],S=(0,n.useState)([]),Z=S[0],O=S[1],I=(0,n.useState)(!0),C=I[0],E=I[1],P=(0,n.useState)(null),q=P[0],L=P[1],A=(0,n.useState)("overview"),M=A[0],Q=A[1];(0,n.useEffect)(function(){null!=t&&t.id&&z()},[t]);var z=(e=(0,s.Z)(c().mark(function e(){var r,n,s,o,i,u,x;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.id){e.next=2;break}return e.abrupt("return");case 2:return E(!0),r=new l(t.id),e.prev=4,e.next=7,Promise.all([r.getProducts(),r.getStockLocations(),r.getLowStockAlerts(!1)]);case 7:return n=e.sent,o=(s=(0,a.Z)(n,3))[0],i=s[1],u=s[2],d(o),v(i),_(u),e.next=17,r.getInventoryItems();case 17:w(x=e.sent),O(D(o,i,x,u)),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(4),console.error("Error loading inventory data:",e.t0),L("Failed to load inventory data. Please try again.");case 27:return e.prev=27,E(!1),e.finish(27);case 30:case"end":return e.stop()}},e,null,[[4,23,27,30]])})),function(){return e.apply(this,arguments)}),D=function(e,r,t,n){var a=[],s=new Map;return n.forEach(function(e){s.set(e.product_id,!0)}),e.forEach(function(e){var n=t.filter(function(r){return r.product_id===e.id}),o=n.reduce(function(e,r){return e+r.quantity},0),c=n.map(function(e){var t=r.find(function(r){return r.id===e.location_id});return{location_id:e.location_id,location_name:(null==t?void 0:t.name)||"Unknown Location",quantity:e.quantity}});a.push({product_id:e.id,product_name:e.name,sku:e.sku,category:e.category,total_quantity:o,locations:c,low_stock:s.has(e.id)||o<=e.low_stock_threshold})}),a},F=function(){return(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,b.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"SKU"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Category"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Quantity"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Z.map(function(e){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.product_name}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.sku}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize",children:e.category}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.total_quantity}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.low_stock?(0,b.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Low Stock"}):(0,b.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"In Stock"})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,b.jsx)("button",{className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:"View Details"})})]},e.product_id)})})]})})})};return(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Inventory Management"}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)("button",{onClick:function(){z()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,b.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,b.jsxs)("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,b.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Add Product"]})]})]}),C?(0,b.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):q?(0,b.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert",children:[(0,b.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,b.jsx)("span",{className:"block sm:inline",children:q}),(0,b.jsxs)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:function(){return L(null)},children:[(0,b.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,b.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,b.jsx)("title",{children:"Close"}),(0,b.jsx)("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,b.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,b.jsx)("button",{onClick:function(){return Q("overview")},className:"".concat("overview"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Overview"}),(0,b.jsx)("button",{onClick:function(){return Q("products")},className:"".concat("products"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Products"}),(0,b.jsx)("button",{onClick:function(){return Q("locations")},className:"".concat("locations"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Locations"}),(0,b.jsxs)("button",{onClick:function(){return Q("alerts")},className:"".concat("alerts"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:["Low Stock Alerts",N.length>0&&(0,b.jsx)("span",{className:"ml-2 bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full dark:bg-red-900 dark:text-red-200",children:N.length})]})]})})}),(0,b.jsxs)("div",{children:["overview"===M&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,b.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[(0,b.jsx)(p,{className:"mr-2 h-5 w-5 text-blue-500"}),"Products"]}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:u.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Total products in inventory"})]}),(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,b.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[(0,b.jsx)(m,{className:"mr-2 h-5 w-5 text-green-500"}),"Locations"]}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:y.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Active storage locations"})]}),(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,b.jsxs)("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[(0,b.jsx)(h.Z,{className:"mr-2 h-5 w-5 text-red-500"}),"Low Stock Alerts"]}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:N.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Items requiring attention"})]})]}),F()]}),"products"===M&&F(),"locations"===M&&(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(function(e){return(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:e.name}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:e.description||"No description"}),(0,b.jsxs)("p",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Code:"})," ",e.location_code]}),(0,b.jsxs)("p",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Status:"})," ",e.is_active?"Active":"Inactive"]}),(0,b.jsx)("div",{className:"mt-4 flex justify-end",children:(0,b.jsx)("button",{className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"View Inventory"})})]},e.id)})}),"alerts"===M&&(0===N.length?(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow text-center",children:(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No low stock alerts at this time."})}):(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,b.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Location"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Current Quantity"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Threshold"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Created"}),(0,b.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:N.map(function(e){var r=u.find(function(r){return r.id===e.product_id}),n=y.find(function(r){return r.id===e.location_id});return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:(null==r?void 0:r.name)||"Unknown Product"}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(null==n?void 0:n.name)||"Unknown Location"}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.current_quantity}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.threshold}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.created_at).toLocaleDateString()}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,b.jsx)("button",{onClick:(0,s.Z)(c().mark(function r(){var n;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t&&t.id){r.next=2;break}return r.abrupt("return");case 2:return n=new l(t.id),r.prev=3,r.next=6,n.resolveLowStockAlert({id:e.id,is_resolved:!0});case 6:z(),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(3),console.error("Error resolving alert:",r.t0),L("Failed to resolve alert. Please try again.");case 13:case"end":return r.stop()}},r,null,[[3,9]])})),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:"Resolve"})})]},e.id)})})]})})}))]})]})]})},v=(0,x.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),k=function(e){var r,t,o=e.onComplete,u=e.onCancel,d=e.productId,x=e.locationId,p=(0,i.$4)().session,m=null==p?void 0:p.user,h=(0,n.useState)([]),f=h[0],y=h[1],k=(0,n.useState)([]),w=k[0],j=k[1],N=(0,n.useState)(!0),_=N[0],S=N[1],Z=(0,n.useState)(!1),O=Z[0],I=Z[1],C=(0,n.useState)(null),E=C[0],P=C[1],q=(0,n.useState)(!1),L=q[0],A=q[1],M=(0,n.useState)(d||""),Q=M[0],z=M[1],D=(0,n.useState)("purchase"),F=D[0],R=D[1],B=(0,n.useState)(x||""),T=B[0],J=B[1],V=(0,n.useState)(x||""),W=V[0],U=V[1],X=(0,n.useState)(1),$=X[0],G=X[1],H=(0,n.useState)(""),Y=H[0],K=H[1],ee=(0,n.useState)(""),er=ee[0],et=ee[1];(0,n.useEffect)(function(){null!=m&&m.id&&en()},[m]);var en=(r=(0,s.Z)(c().mark(function e(){var r,t,n,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=m&&m.id){e.next=2;break}return e.abrupt("return");case 2:return S(!0),r=new l(m.id),e.prev=4,e.next=7,Promise.all([r.getProducts(),r.getStockLocations()]);case 7:t=e.sent,s=(n=(0,a.Z)(t,2))[0],o=n[1],y(s),j(o),d?z(d):s.length>0&&z(s[0].id),x?(J(x),U(x)):o.length>0&&(J(o[0].id),U(o[0].id)),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),console.error("Error loading data:",e.t0),P("Failed to load products and locations. Please try again.");case 21:return e.prev=21,S(!1),e.finish(21);case 24:case"end":return e.stop()}},e,null,[[4,17,21,24]])})),function(){return r.apply(this,arguments)}),ea=(t=(0,s.Z)(c().mark(function e(r){var t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!(!(null!=m&&m.id)||!Q)){e.next=3;break}return e.abrupt("return");case 3:if(P(null),I(!0),e.prev=5,t=new l(m.id),n={product_id:Q,quantity:$,movement_type:F,reference_number:Y||null,notes:er||null,source_location_id:["sale","transfer"].includes(F)?T:null,destination_location_id:["purchase","transfer","count"].includes(F)?W:null},!("purchase"===F&&!W)){e.next=12;break}return P("Destination location is required for purchases"),I(!1),e.abrupt("return");case 12:if(!("sale"===F&&!T)){e.next=16;break}return P("Source location is required for sales"),I(!1),e.abrupt("return");case 16:if(!("transfer"===F&&(!T||!W))){e.next=20;break}return P("Both source and destination locations are required for transfers"),I(!1),e.abrupt("return");case 20:if(!("count"===F&&!W)){e.next=24;break}return P("Location is required for inventory counts"),I(!1),e.abrupt("return");case 24:return e.next=26,t.createStockMovement(n);case 26:e.sent?(A(!0),setTimeout(function(){o?o():(A(!1),es())},1500)):P("Failed to record stock movement. Please try again."),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(5),console.error("Error creating stock movement:",e.t0),P(e.t0.message||"An unexpected error occurred");case 34:return e.prev=34,I(!1),e.finish(34);case 37:case"end":return e.stop()}},e,null,[[5,30,34,37]])})),function(e){return t.apply(this,arguments)}),es=function(){z(f.length>0?f[0].id:""),R("purchase"),J(w.length>0?w[0].id:""),U(w.length>0?w[0].id:""),G(1),K(""),et("")};return _?(0,b.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Record Stock Movement"}),u&&(0,b.jsx)("button",{onClick:u,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,b.jsx)(v,{className:"h-5 w-5"})})]}),E&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 rounded-md",children:E}),L&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-md",children:"Stock movement recorded successfully!"}),(0,b.jsxs)("form",{onSubmit:ea,children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product"}),(0,b.jsxs)("select",{value:Q,onChange:function(e){return z(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select a product"}),f.map(function(e){return(0,b.jsxs)("option",{value:e.id,children:[e.name," (",e.sku,")"]},e.id)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Movement Type"}),(0,b.jsxs)("select",{value:F,onChange:function(e){return R(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,b.jsx)("option",{value:"purchase",children:"Purchase (Add Stock)"}),(0,b.jsx)("option",{value:"sale",children:"Sale (Remove Stock)"}),(0,b.jsx)("option",{value:"transfer",children:"Transfer Between Locations"}),(0,b.jsx)("option",{value:"adjustment",children:"Inventory Adjustment"}),(0,b.jsx)("option",{value:"count",children:"Inventory Count"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[["sale","transfer","adjustment"].includes(F)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"transfer"===F?"Source Location":"Location"}),(0,b.jsxs)("select",{value:T,onChange:function(e){return J(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select a location"}),w.map(function(e){return(0,b.jsxs)("option",{value:e.id,children:[e.name," (",e.location_code,")"]},e.id)})]})]}),["purchase","transfer","count","adjustment"].includes(F)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"transfer"===F?"Destination Location":"Location"}),(0,b.jsxs)("select",{value:W,onChange:function(e){return U(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select a location"}),w.map(function(e){return(0,b.jsxs)("option",{value:e.id,children:[e.name," (",e.location_code,")"]},e.id)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",value:$,onChange:function(e){return G(parseInt(e.target.value)||1)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reference Number (Optional)"}),(0,b.jsx)("input",{type:"text",value:Y,onChange:function(e){return K(e.target.value)},placeholder:"Invoice #, PO #, etc.",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:er,onChange:function(e){return et(e.target.value)},rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Additional details about this stock movement"})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3",children:[u&&(0,b.jsx)("button",{type:"button",onClick:u,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:O,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",disabled:O,children:O?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Processing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Record Movement"]})})]})]})]})},w=function(){var e=(0,n.useState)(!1),r=e[0],t=e[1];return(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[!r&&(0,b.jsx)("div",{className:"flex justify-end mb-6",children:(0,b.jsxs)("button",{onClick:function(){return t(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,b.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Record Stock Movement"]})}),r?(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)(k,{onComplete:function(){return t(!1)},onCancel:function(){return t(!1)}})}):(0,b.jsx)(y,{})]})}},8839:function(e,r,t){"use strict";t.d(r,{$4:function(){return u},OQ:function(){return i}});var n=t(90),a=t(5977),s=t.n(a),o=t(1080),c=t(6871),i=(0,o.createBrowserClient)("https://mtzhxqdhdxdwxwtfcjup.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10emh4cWRoZHhkd3h3dGZjanVwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk2Mzk0MjYsImV4cCI6MjA1NTIxNTQyNn0.vhZdFQUAbPG9NQoyblTrHLXBVE2gomijhz_CliAIdy8");function u(){var e=(0,c.useState)(null),r=e[0],t=e[1],a=(0,c.useState)(!0),o=a[0],u=a[1];return(0,c.useEffect)(function(){var e,r=i.auth.onAuthStateChange((e=(0,n.Z)(s().mark(function e(r,n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t(n),u(!1);case 2:case"end":return e.stop()}},e)})),function(r,t){return e.apply(this,arguments)})).data;return i.auth.getSession().then(function(e){t(e.data.session),u(!1)}),function(){null==r||r.subscription.unsubscribe()}},[]),{supabase:i,session:r,loading:o}}},3366:function(e,r,t){"use strict";function n(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}t.d(r,{Z:function(){return n}})}},function(e){e.O(0,[9762,7972,2971,529,1744],function(){return e(e.s=4195)}),_N_E=e.O()}]);