exports.id=223,exports.ids=[223],exports.modules={95186:(e,t,r)=>{"use strict";r.d(t,{F:()=>x,Z:()=>F});var n=r(31694),i=r(94634),a=r(75542),o=r(70887),s=r(7289);function c(...e){return(0,s.m6)((0,o.W)(e))}var l=r(52166);let u=["className"],m=["className"],d=["className"];function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){var n,i;n=t,i=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function y(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}let b=n.forwardRef((e,t)=>{let{className:r}=e,n=y(e,u);return l.jsx("div",p({ref:t,className:c("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r)},n))});b.displayName="Avatar";let h=n.forwardRef((e,t)=>{let{className:r}=e,n=y(e,m);return l.jsx("img",p({ref:t,className:c("h-full w-full rounded-full",r)},n))});h.displayName="AvatarImage";let v=n.forwardRef((e,t)=>{let{className:r}=e,n=y(e,d);return l.jsx("div",p({ref:t,className:c("flex h-full w-full items-center justify-center rounded-full bg-muted",r)},n))});v.displayName="AvatarFallback";var w=r(51010);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){g(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class _{constructor(){g(this,"flowChannel",void 0),g(this,"reconnectTimer",null),g(this,"RECONNECT_INTERVAL",5e3),g(this,"listeners",new Set),g(this,"presenceListeners",new Set),this.flowChannel=this.initializeChannel()}initializeChannel(){let e=w.OQ.channel("flow_updates",{config:{presence:{key:"userStatus"}}});return e.on("presence",{event:"sync"},()=>{let t=e.presenceState();this.notifyPresenceListeners(this.formatPresenceState(t))}).on("presence",{event:"join"},t=>{console.log("User joined:",t.key);let r=e.presenceState();this.notifyPresenceListeners(this.formatPresenceState(r))}).on("presence",{event:"leave"},t=>{console.log("User left:",t.key);let r=e.presenceState();this.notifyPresenceListeners(this.formatPresenceState(r))}).on("broadcast",{event:"flow_update"},e=>{this.isFlowUpdatePayload(e.payload)&&this.handleFlowUpdate(e.payload)}),e.subscribe(e=>{"CHANNEL_ERROR"===e&&this.handleError(Error("Channel error occurred"))}),this.connect(),e}isFlowUpdatePayload(e){return e&&"flow_update"===e.type&&e.data&&"object"==typeof e.data&&"userId"in e.data&&"score"in e.data&&"status"in e.data}async connect(){try{await this.flowChannel.subscribe(async e=>{"SUBSCRIBED"===e?(await this.trackPresence(),console.log("Successfully connected to flow channel"),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)):("CLOSED"===e||"CHANNEL_ERROR"===e)&&(console.error("Channel connection failed:",e),this.handleReconnect())})}catch(e){console.error("Error connecting to flow channel:",e),this.handleReconnect()}}async trackPresence(){let e=await w.OQ.auth.getUser();e.data.user&&await this.flowChannel.track({userId:e.data.user.id,online:!0,lastSeen:new Date().toISOString()})}handleError(e){console.error("Flow channel error:",e),this.handleReconnect()}handleReconnect(){this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{console.log("Attempting to reconnect..."),this.flowChannel=this.initializeChannel(),this.reconnectTimer=null},this.RECONNECT_INTERVAL))}handleFlowUpdate(e){this.notifyListeners(e.data)}formatPresenceState(e){return Object.entries(e).map(([e,t])=>({userId:e,online:t.online,lastSeen:t.lastSeen}))}notifyListeners(e){this.listeners.forEach(t=>t(e))}notifyPresenceListeners(e){this.presenceListeners.forEach(t=>t(e))}async syncFlow(e){try{let t={type:"flow_update",data:j(j({},e),{},{lastUpdated:new Date().toISOString()})};await this.flowChannel.send({type:"broadcast",event:"flow_update",payload:t}),await w.OQ.from("flow_states").upsert({user_id:e.userId,score:e.score,status:e.status,active_time:e.activeTime,updated_at:new Date().toISOString()})}catch(e){throw console.error("Error syncing flow state:",e),e}}onFlowUpdate(e){return this.listeners.add(e),()=>this.listeners.delete(e)}onPresenceUpdate(e){return this.presenceListeners.add(e),()=>this.presenceListeners.delete(e)}async disconnect(){this.reconnectTimer&&clearTimeout(this.reconnectTimer),await this.flowChannel.unsubscribe()}}let S=new _;var P=r(77675),T=r.n(P);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach(function(t){var n,i;n=t,i=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let x=({teamId:e,currentUserId:t})=>{let{0:r,1:o}=(0,n.useState)([]),{0:s,1:c}=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=S.onFlowUpdate(e=>{o(t=>{let r=t.findIndex(t=>t.userId===e.userId);if(-1===r)return t;let n=[...t];return n[r]=N(N({},n[r]),e),n})}),t=S.onPresenceUpdate(e=>{o(t=>t.map(t=>N(N({},t),{},{online:e.some(e=>e.userId===t.userId&&e.online)}))),c(!0)});return()=>{e(),t()}},[e]);let u=e=>"peak"===e.status?"In deep focus - minimize interruptions":"flow"===e.status?"Good time for quick collaboration":"rest"===e.status?"Taking a break":"Building focus";return(0,l.jsxs)("div",{className:T().container,children:[(0,l.jsxs)("header",{className:T().header,children:[l.jsx("h3",{children:"Team Flow"}),l.jsx("div",{className:T().syncStatus,children:s?"Real-time sync active":"Connecting..."})]}),l.jsx(i.M,{children:l.jsx("div",{className:T().membersGrid,children:r.map((e,t)=>(0,l.jsxs)(a.E.div,{className:T().memberCard,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.1*t},children:[(0,l.jsxs)("div",{className:T().memberHeader,children:[(0,l.jsxs)(b,{className:T().avatar,children:[l.jsx(h,{src:e.avatarUrl}),l.jsx(v,{children:e.name[0]})]}),(0,l.jsxs)("div",{className:T().memberInfo,children:[l.jsx("h4",{children:e.name}),l.jsx("div",{className:`${T().flowStatus} ${T()[e.status]}`,children:e.status})]})]}),(0,l.jsxs)("div",{className:T().flowMetrics,children:[(0,l.jsxs)("div",{className:T().metric,children:[l.jsx("span",{children:"Flow Score"}),l.jsx(a.E.div,{className:T().score,animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:e.score})]}),(0,l.jsxs)("div",{className:T().metric,children:[l.jsx("span",{children:"Active Time"}),(0,l.jsxs)("div",{children:[Math.floor(e.activeTime),"m"]})]})]}),l.jsx("div",{className:T().advice,children:u(e)})]},e.userId))})}),0===r.length&&l.jsx("div",{className:T().empty,children:"No team members currently active"})]})},F=x},7687:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var n=r(8478);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var n,i;n=t,i=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}r(52166);let o=(0,n.Ue)(e=>({toasts:[],addToast:t=>e(e=>({toasts:[...e.toasts,t]})),removeToast:t=>e(e=>({toasts:e.toasts.filter((e,r)=>r!==t)}))}));function s(){let e=o(e=>e.addToast);return{toast:t=>{e(a(a({},t),{},{duration:t.duration??5e3})),setTimeout(()=>{let e=o.getState().toasts.findIndex(e=>e===t);-1!==e&&o.getState().removeToast(e)},t.duration??5e3)}}}},71409:(e,t,r)=>{"use strict";r.d(t,{t:()=>c});var n=r(31694),i=r(96808),a=r(7687);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var n,i;n=t,i=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e){let{0:t,1:r}=(0,n.useState)(null),{0:o,1:c}=(0,n.useState)([]),{0:l,1:u}=(0,n.useState)([]),{0:m,1:d}=(0,n.useState)(!0),{toast:f}=(0,a.p)(),p=(0,i.createClientComponentClient)();return{team:t,members:o,invites:l,loading:m,createTeam:async(e,t)=>{try{let{data:r,error:n}=await p.from("teams").insert([{name:e,description:t}]).select().single();if(n)throw n;let{error:i}=await p.from("team_members").insert([{team_id:r.id,user_id:(await p.auth.getUser()).data.user?.id,role:"admin"}]);if(i)throw i;return f({title:"Success",description:"Team created successfully"}),r}catch(e){return console.error("Error creating team:",e),f({title:"Error",description:"Failed to create team",variant:"destructive"}),null}},inviteMember:async(t,r="member")=>{if(!e)return null;try{let{data:n,error:i}=await p.from("team_invites").insert([{team_id:e,inviter_id:(await p.auth.getUser()).data.user?.id,invitee_email:t,role:r}]).select().single();if(i)throw i;return u(e=>[...e,n]),f({title:"Success",description:`Invitation sent to ${t}`}),n}catch(e){return console.error("Error inviting member:",e),f({title:"Error",description:"Failed to send invitation",variant:"destructive"}),null}},removeMember:async t=>{if(!e)return!1;try{let{error:r}=await p.from("team_members").delete().match({team_id:e,user_id:t});if(r)throw r;return c(e=>e.filter(e=>e.user_id!==t)),f({title:"Success",description:"Team member removed"}),!0}catch(e){return console.error("Error removing member:",e),f({title:"Error",description:"Failed to remove team member",variant:"destructive"}),!1}},updateTeam:async t=>{if(!e)return null;try{let{data:n,error:i}=await p.from("teams").update(t).eq("id",e).select().single();if(i)throw i;return r(e=>e?s(s({},e),t):null),f({title:"Success",description:"Team updated successfully"}),n}catch(e){return console.error("Error updating team:",e),f({title:"Error",description:"Failed to update team",variant:"destructive"}),null}},refreshTeam:(0,n.useCallback)(async()=>{if(e)try{let{data:t,error:n}=await p.from("teams").select("*").eq("id",e).single();if(n)throw n;let{data:i,error:a}=await p.from("team_members").select(`
          user_id,
          team_id,
          role,
          joined_at,
          profiles (
            name,
            avatar_url
          )
        `).eq("team_id",e);if(a)throw a;let{data:o,error:s}=await p.from("team_invites").select("*").eq("team_id",e);if(s)throw s;r(t),c(i.map(e=>({user_id:e.user_id,team_id:e.team_id,role:e.role,joined_at:e.joined_at,profile:{name:e.profiles[0].name,avatar_url:e.profiles[0].avatar_url}}))),u(o)}catch(e){console.error("Error fetching team:",e),f({title:"Error",description:"Failed to fetch team data",variant:"destructive"})}finally{d(!1)}},[e,p,f])}}},77675:e=>{e.exports={container:"TeamFlowSync_container__vCaad",header:"TeamFlowSync_header__y2HNL",syncStatus:"TeamFlowSync_syncStatus__fqyWf",pulse:"TeamFlowSync_pulse__zgzYB",membersGrid:"TeamFlowSync_membersGrid__ZPsEH",memberCard:"TeamFlowSync_memberCard__Md1Cm",memberHeader:"TeamFlowSync_memberHeader__aSwo8",avatar:"TeamFlowSync_avatar__n8bRE",memberInfo:"TeamFlowSync_memberInfo__wzfBO",flowStatus:"TeamFlowSync_flowStatus__1hpKB",peak:"TeamFlowSync_peak__IcjYm",flow:"TeamFlowSync_flow__PShko",rest:"TeamFlowSync_rest__Qs9xN",building:"TeamFlowSync_building__nnXEl",flowMetrics:"TeamFlowSync_flowMetrics__1O3mb",metric:"TeamFlowSync_metric__Esste",score:"TeamFlowSync_score__7n98c",advice:"TeamFlowSync_advice__hs6KZ",empty:"TeamFlowSync_empty__JQA7D"}}};